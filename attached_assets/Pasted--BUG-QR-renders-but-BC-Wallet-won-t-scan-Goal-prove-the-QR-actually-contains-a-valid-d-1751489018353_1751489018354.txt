### ğŸ› ï¸  BUG â€“ QR renders but BC Wallet wonâ€™t scan  
Goal: prove the QR actually contains a valid *didcomm:/* or
https://â€¦?oob=â€¦ invitation.  
If itâ€™s our â€œfallbackâ€ URL, or the payload is malformed, detect & fix it.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1.  Tighten server-side logging
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¸ In  apps/api/routes/initFormProof.ts  

  â€¢ After we receive the **prepare-url** response add:

    console.info('[ORBIT â¬…] prepare-url response', data);

  â€¢ Just before sending the final JSON response add:

    console.info('[QR-DEBUG] invitationUrl', invitationUrl?.slice(0,120));

  â€“ If any Orbit step throws, log the error class & message **once**.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2.  Expose invitation URL in UI (dev-only)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¸ In  VerificationPanel.tsx add (dev mode only):

    {process.env.NODE_ENV !== 'production' && url && (
      <p style={{wordBreak:'break-all',fontSize:10,color:'#888'}}>
        {url}
      </p>
    )}

This lets us eyeball the invitation string under the QR.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3.  Fallback detector
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¸ Treat any invitationUrl that **doesnâ€™t** start with
  - 'didcomm://'
  - 'https://'
  as *invalid*.  
Return 502 with `{status:'invalid-invitation'}` so the panel can show a red
error banner and skip rendering the QR.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4.  Quick manual decode test
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–¸ Add `scripts/dev/decode-qr.ts` â€“ takes SVG text, prints payload string.

  pnpm ts-node scripts/dev/decode-qr.ts <<< "$(curl -s -X POST \
        http://localhost:5000/api/proofs/init-form/7 | jq -r .svg)"

This lets us confirm the QR encodes the same invitationUrl.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5.  Unit + E2E tests (MUST be green)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª unit:  tests/unit/invitationUrl.validation.test.ts  
  â€“ valid strings pass; fallback string triggers validation error.

ğŸ§ª e2e:  tests/e2e/qrValid.e2e.ts  
  â€“ open `/form/7?preview=1`  
  â€“ intercept network 200 â†’ body.invitationUrl startsWith /(didcomm:|https:\/\/)/  
  â€“ ensure `<img>` visible inside panel.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
6.  Iterate until BC Wallet scans
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ If Orbit **prepare-url** still 500â€™s:
    â€“ print the full payload & 500 body to console once
    â€“ fall back to temporary *warning panel* (â€œOrbit error: â€¦â€)  
      but **do not** emit a fake QR â€“ prevents false-positive tests.

â€¢ When BC Wallet finally scans, add screenshot + note to replit.md  
  (â€œâœ… wallet scan confirmed, form 7 birthdate_dateint worksâ€).

##### Remember
*All* new code **must** include/adjust tests; if any test breaks, agent shall
fix before committing.
Commit message:
fix(qr): ensure only valid Orbit invitations rendered
test: add validation + e2e scan coverage